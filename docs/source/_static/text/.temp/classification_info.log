
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
===============================================================================
● CONFIGURATION: dataset__test
===============================================================================
     ▶ LOAD
===============================================================================
Data loaded from:
    data/test_transaction.csv
===============================================================================
     ▶ LOAD
===============================================================================
Data loaded from:
    data/test_identity.csv
===============================================================================
     ▶ MERGE
===============================================================================
     ▶ INFO
===============================================================================
Warning: gaps found: 2033556 0.471%,
    see debug.log for details.
===============================================================================
     ▶ PREPROCESS
===============================================================================
No target column(s) found in df:
    ['isFraud']
===============================================================================
● CONFIGURATION: dataset__train
===============================================================================
     ▶ LOAD
===============================================================================
Data loaded from:
    data/train_transaction.csv
===============================================================================
     ▶ LOAD
===============================================================================
Data loaded from:
    data/train_identity.csv
===============================================================================
     ▶ MERGE
===============================================================================
     ▶ INFO
===============================================================================
Warning: gaps found: 2232677 0.516%,
    see debug.log for details.
===============================================================================
     ▶ PREPROCESS
===============================================================================
     ▶ SPLIT
===============================================================================
● CONFIGURATION: gs_params__stage_1
===============================================================================
● CONFIGURATION: gs_params__stage_2
===============================================================================
● CONFIGURATION: gs_params__stage_3
===============================================================================
● CONFIGURATION: metric__classification_report
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: metric__confusion_matrix
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: metric__custom
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: metric__precision
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: metric__roc_auc
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: pipeline__lgbm
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: pipeline__sgd
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: pipeline__xgb
===============================================================================
     ▶ MAKE
===============================================================================
● CONFIGURATION: resolve_params__stage_2
===============================================================================
● CONFIGURATION: workflow__conf
===============================================================================
     ▶ OPTIMIZE
===============================================================================
hp_grid:
    {
    'estimate__predict_proba__classifier__num_leaves': [2, 4, 8, 16, 32]
}
===============================================================================

===============================================================================
CV results:
+----+---------------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
|    |   param_estimate__predict_proba__classifier__num_leaves |   mean_test_metric__roc_auc |   mean_train_metric__roc_auc |   mean_test_metric__precision |   mean_train_metric__precision |   mean_test_metric__custom |   mean_train_metric__custom |
|----+---------------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------|
|  0 |                                                       2 |                    0.802553 |                     0.953345 |                      1        |                              1 |                   1        |                           1 |
|  1 |                                                       4 |                    0.824767 |                     0.993765 |                      0.809524 |                              1 |                   0.809524 |                           1 |
|  2 |                                                       8 |                    0.820901 |                     1        |                      0.844444 |                              1 |                   0.844444 |                           1 |
|  3 |                                                      16 |                    0.823576 |                     1        |                      0.604167 |                              1 |                   0.604167 |                           1 |
|  4 |                                                      32 |                    0.82171  |                     1        |                      0.615385 |                              1 |                   0.615385 |                           1 |
+----+---------------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
===============================================================================
GridSearch time:
    {'mean_fit_time': 2.227685832977295, 'mean_score_time': 0.36599651972452796}
===============================================================================
GridSearch best index:
    1
===============================================================================
CV best modifiers:
    {
    'estimate__predict_proba__classifier__num_leaves': 4
}
===============================================================================
CV best configuration:
    {
    'estimate__predict_proba__classifier__num_leaves': 4
}
===============================================================================
CV best mean test score metric__roc_auc:
    0.8247670988333206
===============================================================================
Save run(s) results to file:
    /home/nizaevka/Desktop/repos/mlshell/examples/classification/results/runs/1598465643_runs.csv
===============================================================================
Best run id:
    0da9452e-1459-48f6-a39f-8e54f771e883
===============================================================================
     ▶ OPTIMIZE
===============================================================================
hp_grid:
    {
    'estimate__apply_threshold__threshold': array([0.00986924, 0.12395558, 0.32693011, 0.35172646, 0.45083765,
        0.7657276, 0.7657276, 0.97176039, 0.97176039, 1.
    ])
}
===============================================================================

===============================================================================
CV results:
+----+----------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
|    |   param_estimate__apply_threshold__threshold |   mean_test_metric__roc_auc |   mean_train_metric__roc_auc |   mean_test_metric__precision |   mean_train_metric__precision |   mean_test_metric__custom |   mean_train_metric__custom |
|----+----------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------|
|  0 |                                   0.00986924 |                    0.860358 |                     0.788044 |                     0.0814508 |                      0.0509514 |                  0.0814508 |                   0.0509514 |
|  1 |                                   0.123956   |                    0.860358 |                     0.788044 |                     0.578417  |                      0.211551  |                  0.578417  |                   0.211551  |
|  2 |                                   0.32693    |                    0.860358 |                     0.788044 |                     0.855769  |                      0.430952  |                  0.855769  |                   0.430952  |
|  3 |                                   0.351726   |                    0.860358 |                     0.788044 |                     0.855769  |                      0.452242  |                  0.855769  |                   0.452242  |
|  4 |                                   0.450838   |                    0.860358 |                     0.788044 |                     0.897727  |                      0.551404  |                  0.897727  |                   0.551404  |
|  5 |                                   0.765728   |                    0.860358 |                     0.788044 |                     1         |                      0.666667  |                  1         |                   0.666667  |
|  6 |                                   0.765728   |                    0.860358 |                     0.788044 |                     1         |                      0.666667  |                  1         |                   0.666667  |
|  7 |                                   0.97176    |                    0.860358 |                     0.788044 |                     0.333333  |                      0         |                  0.333333  |                   0         |
|  8 |                                   0.97176    |                    0.860358 |                     0.788044 |                     0.333333  |                      0         |                  0.333333  |                   0         |
|  9 |                                   1          |                    0.860358 |                     0.788044 |                     0         |                      0         |                  0         |                   0         |
+----+----------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
===============================================================================
GridSearch time:
    {'mean_fit_time': 0.0002845605214436849, 'mean_score_time': 0.002322697639465332}
===============================================================================
GridSearch best index:
    5
===============================================================================
CV best modifiers:
    {
    'estimate__apply_threshold__threshold': 0.765727600655271
}
===============================================================================
CV best configuration:
    {
    'estimate__apply_threshold__threshold': 0.765727600655271
}
===============================================================================
CV best mean test score metric__custom:
    1.0
===============================================================================
Save run(s) results to file:
    /home/nizaevka/Desktop/repos/mlshell/examples/classification/results/runs/1598465674_runs.csv
===============================================================================
Best run id:
    0a9fac83-c465-4113-aad2-bee0e97b9fc0
===============================================================================
     ▶ OPTIMIZE
===============================================================================
hp_grid:
    {
    'pass_custom__kw_args': [{
        'metric__custom': {
            'param_a': 1,
            'param_b': 'c'
        }
    }, {
        'metric__custom': {
            'param_a': 2,
            'param_b': 'd'
        }
    }]
}
===============================================================================

===============================================================================
CV results:
+----+----------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
|    | param_pass_custom__kw_args                         |   mean_test_metric__roc_auc |   mean_train_metric__roc_auc |   mean_test_metric__precision |   mean_train_metric__precision |   mean_test_metric__custom |   mean_train_metric__custom |
|----+----------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------|
|  0 | {'metric__custom': {'param_a': 1, 'param_b': 'c'}} |                    0.860358 |                     0.788044 |                             1 |                       0.666667 |                          1 |                    0.666667 |
|  1 | {'metric__custom': {'param_a': 2, 'param_b': 'd'}} |                    0.860358 |                     0.788044 |                             1 |                       0.666667 |                          1 |                    0.666667 |
+----+----------------------------------------------------+-----------------------------+------------------------------+-------------------------------+--------------------------------+----------------------------+-----------------------------+
===============================================================================
GridSearch time:
    {'mean_fit_time': 0.0002790292104085287, 'mean_score_time': 0.002388993899027507}
===============================================================================
GridSearch best index:
    0
===============================================================================
CV best modifiers:
    {
    'pass_custom__kw_args': {
        'metric__custom': {
            'param_a': 1,
            'param_b': 'c'
        }
    }
}
===============================================================================
CV best configuration:
    {
    'pass_custom__kw_args': {
        'metric__custom': {
            'param_a': 1,
            'param_b': 'c'
        }
    }
}
===============================================================================
CV best mean test score metric__custom:
    1.0
===============================================================================
Save run(s) results to file:
    /home/nizaevka/Desktop/repos/mlshell/examples/classification/results/runs/1598465690_runs.csv
===============================================================================
Best run id:
    72352874-5b1c-4602-9203-157f0827f32b
===============================================================================
     ▶ VALIDATE
===============================================================================
metric__roc_auc:
===============================================================================
    dataset__train__train:
    0.9759054713151047
===============================================================================
    dataset__train__test:
    0.8660999959312152
===============================================================================
metric__precision:
===============================================================================
    dataset__train__train:
    1.0
===============================================================================
    dataset__train__test:
    1.0
===============================================================================
metric__custom:
===============================================================================
    dataset__train__train:
    1.0
===============================================================================
    dataset__train__test:
    1.0
===============================================================================
metric__classification_report:
===============================================================================
    dataset__train__train:
    +-----------+-------------+------------+------------+-------------+----------------+
    |           |           0 |          1 |   accuracy |   macro avg |   weighted avg |
    |-----------+-------------+------------+------------+-------------+----------------|
    | precision |    0.981316 |   1        |   0.981429 |    0.990658 |       0.981776 |
    | recall    |    1        |   0.244186 |   0.981429 |    0.622093 |       0.981429 |
    | f1-score  |    0.99057  |   0.392523 |   0.981429 |    0.691547 |       0.975875 |
    | support   | 6828        | 172        |   0.981429 | 7000        |    7000        |
    +-----------+-------------+------------+------------+-------------+----------------+
===============================================================================
    dataset__train__test:
    +-----------+-------------+-----------+------------+-------------+----------------+
    |           |           0 |         1 |   accuracy |   macro avg |   weighted avg |
    |-----------+-------------+-----------+------------+-------------+----------------|
    | precision |    0.972566 |  1        |   0.972667 |    0.986283 |       0.973417 |
    | recall    |    1        |  0.11828  |   0.972667 |    0.55914  |       0.972667 |
    | f1-score  |    0.986092 |  0.211538 |   0.972667 |    0.598815 |       0.962081 |
    | support   | 2907        | 93        |   0.972667 | 3000        |    3000        |
    +-----------+-------------+-----------+------------+-------------+----------------+
===============================================================================
metric__confusion_matrix:
===============================================================================
    dataset__train__train:
    +----+-----+------+
    |    |   1 |    0 |
    |----+-----+------|
    |  1 |  42 |  130 |
    |  0 |   0 | 6828 |
    +----+-----+------+
===============================================================================
    dataset__train__test:
    +----+-----+------+
    |    |   1 |    0 |
    |----+-----+------|
    |  1 |  11 |   82 |
    |  0 |   0 | 2907 |
    +----+-----+------+
===============================================================================
     ▶ PREDICT
===============================================================================
Save predictions for dataset__test to file:
    /home/nizaevka/Desktop/repos/mlshell/examples/classification/results/models/workflow__conf|pipeline__lgbm|dataset__train__train|('metric__custom', 1.0)|-7931226947362226609|0|dataset__test|-257442441206201706_pred.csv
===============================================================================
     ▶ DUMP
===============================================================================
Save fitted model to file:
    /home/nizaevka/Desktop/repos/mlshell/examples/classification/results/models/workflow__conf|pipeline__lgbm|dataset__train__train|('metric__custom', 1.0)|-7931226947362226609|0||0.model
===============================================================================
